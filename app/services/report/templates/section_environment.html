<style>
  /* TCFD 스타일 */
  .tcfd-section {
    margin: 30px 0;
  }

  .tcfd-header {
    background: #1e3a5f;
    color: white;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 0.5px;
    border-left: 4px solid #0066cc;
  }

  .tcfd-content {
    background: white;
    border: 1px solid #d0d7de;
  }

  .tcfd-table {
    width: 100%;
    border-collapse: collapse;
    margin: 0;
    font-size: 10px;
  }

  .tcfd-table th {
    background: #f6f8fa;
    color: #24292f;
    font-weight: 600;
    padding: 8px 10px;
    text-align: center;
    border-top: 1px solid #d0d7de;
    border-bottom: 1px solid #d0d7de;
    border-right: 1px solid #d0d7de;
  }

  .tcfd-table th:last-child {
    border-right: none;
  }

  .tcfd-table td {
    padding: 8px 10px;
    border-bottom: 1px solid #eaeef2;
    border-right: 1px solid #eaeef2;
    color: #24292f;
    line-height: 1.3;
  }

  .tcfd-table td:last-child {
    border-right: none;
  }

  .tcfd-table tr:last-child td {
    border-bottom: none;
  }

  .tcfd-table tr:nth-child(even) {
    background: #f8f9fa;
  }

  /* 번호 컬럼 스타일 */
  .tcfd-number {
    width: 40px;
    text-align: center;
    font-weight: 600;
    color: #656d76;
  }

  /* 메트릭 강조 */
  .metric-value {
    font-weight: normal;
    color: #0969da;
    font-size: 10px !important;
  }

  /* 리스크 레벨 색상 */
  .risk-high { color: #d1242f; font-weight: 600; }
  .risk-medium { color: #fb8500; font-weight: 600; }
  .risk-low { color: #1f883d; font-weight: 600; }
</style>


<section>
  <!-- 환경 개요 -->
  <div class="tcfd-section">
    <div class="tcfd-header">ENVIRONMENTAL OVERVIEW</div>
    <div class="tcfd-content">
      <table class="tcfd-table">
        <thead>
          <tr>
            <th style="width: 40px;">No.</th>
            <th>환경 지표</th>
            <th style="width: 120px;">측정값</th>
          </tr>
        </thead>
        <tbody>
          {% for k, v in section.metrics.overview.items() %}
          <tr>
            <td class="tcfd-number">{{ loop.index }}</td>
            <td>{{ k }}</td>
            <td class="metric-value">{{ v if v is not none else 'N/A' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- 핵심 성과지표 -->
  <div class="tcfd-section">
    <div class="tcfd-header">KEY PERFORMANCE INDICATORS</div>
    <div class="tcfd-content">
      <table class="tcfd-table">
        <thead>
          <tr>
            <th style="width: 40px;">No.</th>
            <th>지표명</th>
            <th style="width: 100px;">측정값</th>
            <th>비고</th>
          </tr>
        </thead>
        <tbody>
          {% for row in section.metrics.kpis %}
          <tr>
            <td class="tcfd-number">{{ loop.index }}</td>
            <td>{{ row.label }}</td>
            <td class="metric-value">{{ row.value if row.value is not none else 'N/A' }}</td>
            <td>{{ row.note if row.note else '-' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</section>

<div class="page-break"></div>

<section>
  <!-- 주요 성과 및 리스크 -->
  <div class="tcfd-section">
    <div class="tcfd-header">HIGHLIGHTS & RISK ASSESSMENT</div>
    <div class="tcfd-content">
      <table class="tcfd-table">
        <thead>
          <tr>
            <th style="width: 40px;">No.</th>
            <th style="width: 80px;">구분</th>
            <th>내용</th>
          </tr>
        </thead>
        <tbody>
          {% for h in section.metrics.highlights %}
          <tr>
            <td class="tcfd-number">{{ loop.index }}</td>
            <td><span class="risk-low">성과</span></td>
            <td><strong>{{ h.title }}</strong><br>{{ h.desc }}</td>
          </tr>
          {% endfor %}
          {% for r in section.metrics.risks %}
          <tr>
            <td class="tcfd-number">{{ loop.index + section.metrics.highlights|length }}</td>
            <td><span class="risk-medium">리스크</span></td>
            <td><strong>{{ r.risk }}</strong><br><em>대응방안:</em> {{ r.mitigation }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- 실행 계획 -->
  <div class="tcfd-section">
    <div class="tcfd-header">ACTION PLANS</div>
    <div class="tcfd-content">
      <table class="tcfd-table">
        <thead>
          <tr>
            <th style="width: 40px;">No.</th>
            <th>실행 항목</th>
            <th style="width: 160px;">예상 효과</th>
          </tr>
        </thead>
        <tbody>
          {% for a in section.metrics.actions %}
          <tr>
            <td class="tcfd-number">{{ loop.index }}</td>
            <td>{{ a.action }}</td>
            <td>{{ a.impact }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- 연도별 추세 -->
  {% if section.metrics.trends and section.metrics.trends|length > 0 %}
  <div class="tcfd-section">
    <div class="tcfd-header">HISTORICAL TRENDS</div>
    <div class="tcfd-content">
      <table class="tcfd-table">
        <thead>
          <tr>
            <th style="width: 60px;">연도</th>
            <th>에너지 사용량<br><small>(MWh)</small></th>
            <th>온실가스 배출량<br><small>(tCO₂e)</small></th>
            <th>재생에너지 비율<br><small>(%)</small></th>
          </tr>
        </thead>
        <tbody>
          {% for t in section.metrics.trends %}
          <tr>
            <td class="tcfd-number">{{ t.year or t.get('year', 'N/A') }}</td>
            <td style="text-align: right;" class="metric-value">{{ "{:,.1f}".format(t.energy_use) if t.energy_use else 'N/A' }}</td>
            <td style="text-align: right;" class="metric-value">{{ "{:,.1f}".format(t.ghg_emissions or t.green_use) if (t.ghg_emissions or t.green_use) else 'N/A' }}</td>
            <td style="text-align: right;" class="metric-value">{{ "{:.1%}".format(t.renewable_ratio) if t.renewable_ratio else 'N/A' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}
</section>
